<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>GRAND SLOT ONLINE</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;500;700&display=swap');
        body { font-family: 'Kanit', sans-serif; background: #000; color: white; text-align: center; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .auth-box { background: #1a1a1a; padding: 40px; border-radius: 30px; border: 1px solid #f1c40f; width: 320px; }
        input { width: 100%; padding: 15px; margin: 10px 0; border-radius: 12px; border: 1px solid #444; background: #000; color: #fff; text-align: center; box-sizing: border-box; }
        button { width: 100%; padding: 15px; border-radius: 12px; border: none; background: #f1c40f; font-weight: bold; cursor: pointer; margin-top: 10px; }
        #game-page { display: none; }
        .slot-container { display: flex; justify-content: center; margin: 20px 0; }
        .slot { width: 70px; height: 90px; background: #fff; color: #000; font-size: 3rem; display: flex; align-items: center; justify-content: center; border-radius: 10px; margin: 5px; }
    </style>
</head>
<body>

    <div id="auth-page" class="auth-box">
        <h1 style="color:#f1c40f">GRAND SLOT</h1>
        <input type="tel" id="phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå" maxlength="10">
        <input type="password" id="pass" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô">
        <button onclick="handleAuth()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö / ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</button>
    </div>

    <div id="game-page">
        <div style="background:#222; padding:10px 20px; border-radius:50px; border:1px solid #f1c40f; margin-bottom:20px;">
            üì± <span id="u-phone"></span> | ü™ô <span id="u-credit">0</span>
        </div>
        <div class="slot-container">
            <div class="slot" id="s1">üé∞</div><div class="slot" id="s2">üé∞</div><div class="slot" id="s3">üé∞</div>
        </div>
        <button onclick="spin()" style="width:200px; font-size:1.2rem;">SPIN (10 ü™ô)</button>
        <p onclick="location.reload()" style="color:red; cursor:pointer; margin-top:20px;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</p>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBxOPmuzr7tqnz3v1pLCq3ehHtUEKsTjNc",
            authDomain: "grandslotonline.firebaseapp.com",
            databaseURL: "https://grandslotonline-default-rtdb.firebaseio.com",
            projectId: "grandslotonline",
            storageBucket: "grandslotonline.firebasestorage.app",
            messagingSenderId: "649961955570",
            appId: "1:649961955570:web:218ad27d02d0dc83a3706b"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        let currentUser = null;

        async function handleAuth() {
            const phone = document.getElementById('phone').value;
            const pass = document.getElementById('pass').value;
            if(phone.length < 10) return alert("‡πÉ‡∏™‡πà‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 10 ‡∏´‡∏•‡∏±‡∏Å");

            const snapshot = await db.ref('users/' + phone).once('value');
            const user = snapshot.val();

            if (user) {
                if (user.password === pass) loginSuccess(phone);
                else alert("‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î!");
            } else {
                await db.ref('users/' + phone).set({ password: pass, credits: 100 });
                alert("‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏£‡∏±‡∏ö‡∏ü‡∏£‡∏µ 100 ‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï");
                loginSuccess(phone);
            }
        }

        function loginSuccess(phone) {
            currentUser = phone;
            document.getElementById('auth-page').style.display = 'none';
            document.getElementById('game-page').style.display = 'block';
            document.getElementById('u-phone').textContent = phone;
            db.ref('users/' + phone + '/credits').on('value', (snap) => {
                document.getElementById('u-credit').textContent = snap.val();
            });
        }

        async function spin() {
            const snap = await db.ref('users/' + currentUser + '/credits').get();
            let credits = snap.val();
            if (credits < 10) return alert("‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏°‡∏î!");

            const isWin = Math.random() <= 0.3; // ‡πÇ‡∏≠‡∏Å‡∏≤‡∏™‡∏ä‡∏ô‡∏∞ 30%
            const change = isWin ? 100 : -10;
            
            await db.ref('users/' + currentUser + '/credits').set(credits + change);
            await db.ref('logs').push({
                phone: currentUser,
                type: isWin ? "Win" : "Loss",
                amount: change,
                time: new Date().toLocaleString('th-TH')
            });

            alert(isWin ? "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏ô‡∏∞ +100" : "‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à‡∏î‡πâ‡∏ß‡∏¢ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞");
        }
    </script>
</body>
</html>
